
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search code documentation &#8212; TRAL 2.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/tral.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sequence code documentation" href="sequence.html" />
    <link rel="prev" title="Repeat_list code documentation" href="repeat_list.html" />
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700|Source+Code+Pro|Armata|IM+Fell+English'
          rel='stylesheet' type='text/css' />
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
    <a href="http://www.isb-sib.ch/" class="sib_logo" title="SIB Swiss Institute of Bioinformatics"><img src="../_static/sib.png" alt="SIB" class="sib_logo" /></a>
    <a href="../index.html">
      <img class="headlogo" src="../_static/trallogo.png" alt="TRAL" />
      <span class="headlogo">Tandem Repeat Annotation Library</span>
    </a>
    <div class="headlinks">
        <a href="../index.html">Home</a>
        <a href="../install.html">Install</a>
        <a href="../code_docs.html">Code docs</a>
    </div>
</div>


      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Search code documentation</a><ul>
<li><a class="reference internal" href="#module-tral.search.search_hmm">search_hmm</a></li>
<li><a class="reference internal" href="#module-tral.search.filter_hmm">filter_hmm</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="repeat_list.html"
                        title="previous chapter">Repeat_list code documentation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="sequence.html"
                        title="next chapter">Sequence code documentation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tral/search.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="search-code-documentation">
<h1>Search code documentation<a class="headerlink" href="#search-code-documentation" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">search</span></code> submodule documentation.</p>
<div class="section" id="module-tral.search.search_hmm">
<span id="search-hmm"></span><h2>search_hmm<a class="headerlink" href="#module-tral.search.search_hmm" title="Permalink to this headline">¶</a></h2>
<p>Tool to search an HMM against a database of sequences</p>
<p>May be run as a module, e.g. <cite>python -m tral.search.search_hmm -h</cite></p>
<dl class="py class">
<dt id="tral.search.search_hmm.TralHit">
<em class="property">class </em><code class="sig-prename descclassname">tral.search.search_hmm.</code><code class="sig-name descname">TralHit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">id</span></em>, <em class="sig-param"><span class="n">prob</span></em>, <em class="sig-param"><span class="n">logodds</span></em>, <em class="sig-param"><span class="n">states</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/search_hmm.html#TralHit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.search_hmm.TralHit" title="Permalink to this definition">¶</a></dt>
<dd><p>Encapsulates key information about a TRAL search result.</p>
<p>This is similar to some objects from the <cite>tral.repeat</cite> package, but collects
data together and provides serialization methods.</p>
<dl class="py method">
<dt id="tral.search.search_hmm.TralHit.parse_line">
<em class="property">classmethod </em><code class="sig-name descname">parse_line</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/search_hmm.html#TralHit.parse_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.search_hmm.TralHit.parse_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a line from the TSV serialization to a TralHit</p>
<p>Inverse of to_line()</p>
<p>Args:
-  line (str): TSV-separated line representing one hit</p>
<p>Returns:
A new TralHit instance</p>
</dd></dl>

<dl class="py method">
<dt id="tral.search.search_hmm.TralHit.to_line">
<code class="sig-name descname">to_line</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/search_hmm.html#TralHit.to_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.search_hmm.TralHit.to_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts this hit to a tab-delimited line</p>
<p>Does not include endline.</p>
<p>May be recreated by <cite>parse_line(line)</cite></p>
<p>Return: (str)</p>
</dd></dl>

<dl class="py method">
<dt id="tral.search.search_hmm.TralHit.to_treks">
<code class="sig-name descname">to_treks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sequence</span></em>, <em class="sig-param"><span class="n">hmm</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/search_hmm.html#TralHit.to_treks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.search_hmm.TralHit.to_treks" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts this hit to T-REKS format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> (<em>str</em><em> or </em><em>Bio.SeqRecord</em><em> or </em><em>Bio.Seq</em>) – sequence for this hit</p></li>
<li><p><strong>hmm</strong> (<a class="reference internal" href="hmm.html#tral.hmm.hmm.HMM" title="tral.hmm.hmm.HMM"><em>hmm.HMM</em></a>) – (optional) the HMM used to generate this hit. If specified,
results in more accurate set of states</p></li>
</ul>
</dd>
</dl>
<p>Return: (str)</p>
<p>See: tral.sequence.repeat_detection_io.treks_get_repeats</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="tral.search.search_hmm.main">
<code class="sig-prename descclassname">tral.search.search_hmm.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/search_hmm.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.search_hmm.main" title="Permalink to this definition">¶</a></dt>
<dd><p>search_hmm main method</p>
</dd></dl>

<dl class="py function">
<dt id="tral.search.search_hmm.opengzip">
<code class="sig-prename descclassname">tral.search.search_hmm.</code><code class="sig-name descname">opengzip</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/search_hmm.html#opengzip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.search_hmm.opengzip" title="Permalink to this definition">¶</a></dt>
<dd><p>Open a file, which may optionally be gzip’d</p>
<p>Checks the magic bytes to see if the file was compressed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>-</em>) – Filename</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An open file handle</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tral.search.search_hmm.shuffle_seq">
<code class="sig-prename descclassname">tral.search.search_hmm.</code><code class="sig-name descname">shuffle_seq</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seq</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/search_hmm.html#shuffle_seq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.search_hmm.shuffle_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly shuffle a sequence</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seq</strong> (<em>-</em>) – input sequence</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bio.Seq.MutableSeq with suffled characters</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-tral.search.filter_hmm">
<span id="filter-hmm"></span><h2>filter_hmm<a class="headerlink" href="#module-tral.search.filter_hmm" title="Permalink to this headline">¶</a></h2>
<p>Filter search_hmm results according to various statistics</p>
<p>May be run as a module, e.g. <cite>python -m tral.search.filter_hmm -h</cite></p>
<p>Filtering is performed by <cite>filter_search_results</cite>. Other methods provide
I/O and supporting roles.</p>
<dl class="py function">
<dt id="tral.search.filter_hmm.count_repeats">
<code class="sig-prename descclassname">tral.search.filter_hmm.</code><code class="sig-name descname">count_repeats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">states</span></em>, <em class="sig-param"><span class="n">hmm_length</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/filter_hmm.html#count_repeats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.filter_hmm.count_repeats" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of repeats matched by the hmm.</p>
<p>Partial repeats at the beginning and end of the hmm</p>
<p>For example, consider a 3-column HMM with the following states:</p>
<blockquote>
<div><p>N N N M2 M3 M1 I1 M2 M1 M2 C C C</p>
</div></blockquote>
<p>This would have .6+1+.6=2.3 repeats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>states</strong> (<em>-</em>) – list of states traversed by the hmm. Only
match states (starting with ‘M’) are considered, and are assumed
to be numbered sequentially from 1</p></li>
<li><p><strong>hmm_length</strong> (<em>-</em>) – number of HMM states. If not given, guessed based
on the observed states (may be inaccurate)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(float) Number of repeats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tral.search.filter_hmm.filter_fasta">
<code class="sig-prename descclassname">tral.search.filter_hmm.</code><code class="sig-name descname">filter_fasta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">databasefile</span></em>, <em class="sig-param"><span class="n">outfile</span></em>, <em class="sig-param"><span class="n">hits</span></em>, <em class="sig-param"><span class="n">usedescription</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/filter_hmm.html#filter_fasta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.filter_hmm.filter_fasta" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter a fasta file to IDs contained in the hits</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>databasefile</strong> – Name of input fasta. May be gzipped</p></li>
<li><p><strong>outfile</strong> – Name of output fasta. Uncompressed.</p></li>
<li><p><strong>hits</strong> – Iterable of TralHits</p></li>
<li><p><strong>usedescription</strong> – Include full description (header line) from the input
fasta database. If false, only the name (first word after the ‘&gt;’) will
be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tral.search.filter_hmm.filter_search_results">
<code class="sig-prename descclassname">tral.search.filter_hmm.</code><code class="sig-name descname">filter_search_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">results</span></em>, <em class="sig-param"><span class="n">repeats</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">log_odds</span><span class="o">=</span><span class="default_value">8.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/filter_hmm.html#filter_search_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.filter_hmm.filter_search_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the set of hits passing the specified filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results</strong> – TSV file with TRAL hits</p></li>
<li><p><strong>repeats</strong> – minimum number of repeats</p></li>
<li><p><strong>log_odds</strong> – minimum log odds score</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Generator for all hits</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tral.search.filter_hmm.main">
<code class="sig-prename descclassname">tral.search.filter_hmm.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/filter_hmm.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.filter_hmm.main" title="Permalink to this definition">¶</a></dt>
<dd><p>filter_hmm main method</p>
</dd></dl>

<dl class="py function">
<dt id="tral.search.filter_hmm.match_seqs">
<code class="sig-prename descclassname">tral.search.filter_hmm.</code><code class="sig-name descname">match_seqs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hits</span></em>, <em class="sig-param"><span class="n">fastafile</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/filter_hmm.html#match_seqs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.filter_hmm.match_seqs" title="Permalink to this definition">¶</a></dt>
<dd><p>Pair a series of hits with sequences</p>
<p>Requires loading fastafile into memory</p>
<p>Return: generator of (TralHit, SeqRecord) tuples</p>
</dd></dl>

<dl class="py function">
<dt id="tral.search.filter_hmm.parse_hits">
<code class="sig-prename descclassname">tral.search.filter_hmm.</code><code class="sig-name descname">parse_hits</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">results</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/filter_hmm.html#parse_hits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.filter_hmm.parse_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator for hits from a search_hmm output TSV file</p>
</dd></dl>

<dl class="py function">
<dt id="tral.search.filter_hmm.write_hits">
<code class="sig-prename descclassname">tral.search.filter_hmm.</code><code class="sig-name descname">write_hits</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hits</span></em>, <em class="sig-param"><span class="n">outfile</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/filter_hmm.html#write_hits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.filter_hmm.write_hits" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a collection of hits to a TSV file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hits</strong> – iterable of TralHit</p></li>
<li><p><strong>outfile</strong> – filename</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="tral.search.filter_hmm.write_treks">
<code class="sig-prename descclassname">tral.search.filter_hmm.</code><code class="sig-name descname">write_treks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">databasefile</span></em>, <em class="sig-param"><span class="n">outfile</span></em>, <em class="sig-param"><span class="n">hits</span></em>, <em class="sig-param"><span class="n">hmm</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tral/search/filter_hmm.html#write_treks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.search.filter_hmm.write_treks" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a collection of hits as a TREKS file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hits</strong> – iterable of TralHit</p></li>
<li><p><strong>outfile</strong> – filename</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>


  </body>
</html>