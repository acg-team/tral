<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Repeat code documentation &mdash; TRAL 0.3.5 documentation</title>
    
    <link rel="stylesheet" href="_static/tral.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="TRAL 0.3.5 documentation" href="index.html" />
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700|Source+Code+Pro|Armata|IM+Fell+English'
          rel='stylesheet' type='text/css' />
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head>
  <body role="document">
<div class="pageheader">
    <a href="http://www.isb-sib.ch/" class="sib_logo" title="SIB Swiss Institute of Bioinformatics"><img src="_static/sib.png" alt="SIB" class="sib_logo" /></a>
    <a href="index.html">
      <img class="headlogo" src="_static/trallogo.png" alt="TRAL" />
      <span class="headlogo">Tandem Repeat Annotation Library</span>
    </a>
    <div class="headlinks">
        <a href="index.html">Home</a>
        <a href="install.html">Install</a>
        <a href="code_docs.html">Code docs</a>
    </div>
</div>


      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Repeat code documentation</a><ul>
<li><a class="reference internal" href="#module-tral.repeat.repeat">repeat</a></li>
<li><a class="reference internal" href="#module-tral.repeat.repeat_align">repeat_align</a></li>
<li><a class="reference internal" href="#module-tral.repeat.repeat_exon">repeat_exon</a></li>
<li><a class="reference internal" href="#module-tral.repeat.repeat_io">repeat_io</a></li>
<li><a class="reference internal" href="#module-tral.repeat.repeat_pvalue">repeat_pvalue</a></li>
<li><a class="reference internal" href="#module-tral.repeat.repeat_score">repeat_score</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/repeat.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="repeat-code-documentation">
<h1>Repeat code documentation<a class="headerlink" href="#repeat-code-documentation" title="Permalink to this headline">¶</a></h1>
<p>Initial version of the repeat submodule documentation.</p>
<div class="section" id="module-tral.repeat.repeat">
<span id="repeat"></span><h2>repeat<a class="headerlink" href="#module-tral.repeat.repeat" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">synopsis:</th><td class="field-body">The Repeat Class.</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="tral.repeat.repeat.Repeat">
<em class="property">class </em><code class="descclassname">tral.repeat.repeat.</code><code class="descname">Repeat</code><span class="sig-paren">(</span><em>msa, begin=None, sequence_type='AA', scoreslist=['phylo_gap01'], calc_score=True, calc_pvalue=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Tandem repeats are consecutive copies of genomic sequence.</p>
<p>A tandem repeat is stored in terms of a multiple sequence alignment of its
tandem repeat units. For example, the amino acid tandem repeat
KLMKLMKLKLM
can be displayed as a multiple sequence alignment (here: &#8220;multiple repeat
unit alignment&#8221;)
KLM
KLM
KL-
KLM
and can be stored as
[&#8220;KLM&#8221;, &#8220;KLM&#8221;, &#8220;KL-&#8221;, &#8220;KLM&#8221;].
The - char stands for a gap: It indicates that either, there used to be a
char at the same position, but it got deleted. Or, all other chars in the
same column got inserted at some point.</p>
<p>For research on tandem repeats, many different statistics need to be
calculated on the multiple sequence alignment of the tandem repeat.</p>
<p>[Description of these statistics]</p>
<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.msa_original">
<code class="descname">msa_original</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.msa_original" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of str</em></p>
<p>The original alignment of repeat units.</p>
</dd></dl>

<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.msa">
<code class="descname">msa</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.msa" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of str</em></p>
<p>The alignment of repeat units without rare chars.</p>
</dd></dl>

<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.msaT">
<code class="descname">msaT</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.msaT" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of str</em></p>
<p>The transposed alignment of repeat units. E.g.
[&#8220;KKKK&#8221;, &#8220;LLLL&#8221;, &#8220;MM-M&#8221;].</p>
</dd></dl>

<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.sequence_type">
<code class="descname">sequence_type</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.sequence_type" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em></p>
<p>&#8220;AA&#8221; or &#8220;DNA&#8221;</p>
</dd></dl>

<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.n">
<code class="descname">n</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.n" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>The number of repeat units in the original msa. E.g. 4.</p>
</dd></dl>

<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.l_msa">
<code class="descname">l_msa</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.l_msa" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>The length of the repeat units in the original msa.
E.g. 3.</p>
</dd></dl>

<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.l_effective">
<code class="descname">l_effective</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.l_effective" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>The number of columns in the original msa not
counting insertion columns (i.e. columns with more
gaps than chars).</p>
</dd></dl>

<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.n_effective">
<code class="descname">n_effective</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.n_effective" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>The number of chars in the MSA without insertion
columns divided by n_effective.</p>
</dd></dl>

<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.text">
<code class="descname">text</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.text" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em></p>
<p>The repeat region of the tandem repeats (e.g. all chars in
the MSA without gaps concatenated.)</p>
</dd></dl>

<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.n_gaps">
<code class="descname">n_gaps</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.n_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>The number of gaps in <code class="docutils literal"><span class="pre">msa</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="tral.repeat.repeat.Repeat.repeat_region_length">
<code class="descname">repeat_region_length</code><a class="headerlink" href="#tral.repeat.repeat.Repeat.repeat_region_length" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em></p>
<p>The lengths of <em>text</em></p>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.__str__">
<code class="descname">__str__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.__str__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create string for Repeat instance.</p>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.calc_index_msa">
<code class="descname">calc_index_msa</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.calc_index_msa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.calc_index_msa" title="Permalink to this definition">¶</a></dt>
<dd><p>formerly named: set_begin</p>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.calc_n_effective">
<code class="descname">calc_n_effective</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.calc_n_effective"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.calc_n_effective" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the effective number of repeat units n_effective</p>
<p>Calculate the number of letters in in all non-insertion columns,
divided by &lt;l_effective&gt;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>self</strong> (<em>Repeat instance</em>) &#8211; </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.calculate_pvalues">
<code class="descname">calculate_pvalues</code><span class="sig-paren">(</span><em>scoreslist=['phylo_gap01']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.calculate_pvalues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.calculate_pvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate pvalues on a Repeat instance.</p>
<p>Calculate pvalues on a Repeat instance for all scores in <cite>scoreslist</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>self</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; An instance of the repeat class.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>scoreslist(list of Str): A list of the names of the scores (e.g.
[&#8220;phylo_gap01&#8221;]) for which p-Values are calculated on the
Repeat instance <cite>self</cite></dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.calculate_scores">
<code class="descname">calculate_scores</code><span class="sig-paren">(</span><em>scoreslist=['phylo_gap01']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.calculate_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.calculate_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate scores on a Repeat instance.</p>
<p>Calculate scores on a Repeat instance for all scores in <cite>scoreslist</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>self</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; An instance of the repeat class.</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd><dl class="first last docutils">
<dt>scoreslist(list of str): A list of the names of the scores (e.g.</dt>
<dd>[&#8220;phylo_gap01&#8221;]) that are calculated on the Repeat instance <cite>self</cite></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.create">
<code class="descname">create</code><span class="sig-paren">(</span><em>file</em>, <em>input_format</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Read tandem repeat from file.</p>
<p>Read tandem repeat from file (currently, only pickle is supported)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>format</strong> (<em>str</em>) &#8211; Currently only &#8220;pickle&#8221;</li>
<li><strong>file</strong> (<em>str</em>) &#8211; Path to output file</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Write checks for <code class="docutils literal"><span class="pre">format</span></code> and <code class="docutils literal"><span class="pre">file</span></code>.</p>
</div>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">Write tests.</p>
</div>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">Can repeat_io.read_fasta be replaced by e.g. BioPython seqIO?</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.delete_insertion_columns">
<code class="descname">delete_insertion_columns</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.delete_insertion_columns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.delete_insertion_columns" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Create the tandem repeat attributes <cite>msa</cite>, <cite>masT</cite>, <cite>l</cite> and <cite>n</cite></dt>
<dd>without insertion columns.</dd>
</dl>
<p>We define insertion columns as columns where there are more or equal
gaps compared to chars.
These columns are removed from both <cite>msa</cite> to create <cite>msaD</cite> and <cite>msaT</cite>
to create <cite>msaTD</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.gap_structure">
<code class="descname">gap_structure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.gap_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.gap_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the number and length of insertions and deletions for
this tandem repeat.</p>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.gap_structure_HMM">
<code class="descname">gap_structure_HMM</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.gap_structure_HMM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.gap_structure_HMM" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Calculate for each column in the transposed multiple repeat unit</dt>
<dd><p class="first">alignment <cite>msaTD</cite></p>
<ul class="last">
<li><dl class="first docutils">
<dt>how many deletions of what length begin in this column?:</dt>
<dd><p class="first last"><cite>deletion_lengths`[`iColumn</cite>] = list of deletion lengths</p>
</dd>
</dl>
</li>
<li><p class="first">how many insertions of what length begin in potential insertion
columns before this column?:
<cite>insertion_lengths`[`iColumn</cite>] = list of insertion lengths</p>
</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>self</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; An instance of the repeat class.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.realign_TR">
<code class="descname">realign_TR</code><span class="sig-paren">(</span><em>realignment='proPIP'</em>, <em>rate_distribution='constant'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.realign_TR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.realign_TR" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Realign multiple sequence alignment of tandem repeats.</dt>
<dd>Update of tandem repeat MSA.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>self</strong> (<em>Repeat instance</em>) &#8211; </li>
<li><strong>realignment</strong> (<em>str</em>) &#8211; either &#8220;proPIP&#8221; or &#8220;mafft&#8221;</li>
<li><strong>rate_distribution</strong> (<em>str</em>) &#8211; either &#8220;constant&#8221; or &#8220;gamma&#8221; (per default value from REPEAT_CONFIG[&#8216;castor_parameter&#8217;][&#8216;rate_distribution&#8217;])</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.save_original_msa">
<code class="descname">save_original_msa</code><span class="sig-paren">(</span><em>sequence</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.save_original_msa"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.save_original_msa" title="Permalink to this definition">¶</a></dt>
<dd><p>recalculate the original msa, assuming that begin is defined
correctly (index starting counting on 1.) This function might be
obsolete when the original MSA is saved from the beginning.</p>
</dd></dl>

<dl class="method">
<dt id="tral.repeat.repeat.Repeat.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>file</em>, <em>file_format</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#Repeat.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.Repeat.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write tandem repeat to file.</p>
<p>Write tandem repeat to file using one of three formats.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>file</strong> (<em>str</em>) &#8211; Path to input file</li>
<li><strong>file_format</strong> (<em>str</em>) &#8211; Either &#8220;fasta&#8221;, &#8220;pickle&#8221; or &#8220;stockholm&#8221;</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p class="last">Write checks for <code class="docutils literal"><span class="pre">format</span></code> and <code class="docutils literal"><span class="pre">file</span></code>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat.calculate_position_in_alignment">
<code class="descclassname">tral.repeat.repeat.</code><code class="descname">calculate_position_in_alignment</code><span class="sig-paren">(</span><em>begin</em>, <em>length</em>, <em>alignment</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat.html#calculate_position_in_alignment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat.calculate_position_in_alignment" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Calculate the index of the begin and the end of a TR within an alignment</dt>
<dd><p class="first">returns</p>
<p class="last">Calculate the index of the begin and the end of a TR within an alignment
returns</p>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>begin</strong> (<em>int</em>) &#8211; (needs explaining)</li>
<li><strong>length</strong> (<em>int</em>) &#8211; (needs explaining)</li>
<li><strong>alignment</strong> &#8211; (needs explaining)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tral.repeat.repeat_align">
<span id="repeat-align"></span><h2>repeat_align<a class="headerlink" href="#module-tral.repeat.repeat_align" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">synopsis:</th><td class="field-body">Alignment of tandem repeat units.</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="tral.repeat.repeat_align.realign_repeat">
<code class="descclassname">tral.repeat.repeat_align.</code><code class="descname">realign_repeat</code><span class="sig-paren">(</span><em>my_msa</em>, <em>realignment='mafft'</em>, <em>sequence_type='AA'</em>, <em>rate_distribution='constant'</em>, <em>user_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_align.html#realign_repeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_align.realign_repeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Realignment of a repeat MSA using mafft or proPIP</p>
<p>A good multiple sequence alignment (MSA) is an important description of a
tandem repeat (TR) and can be crucial to distinguish a true positive from
a false positive TR.
This can be realised using a proper MSA estimation algorithm. Currently,
Mafft and proPIP can be used to realign a TR.</p>
<dl class="docutils">
<dt>For proPIP the rate distribution for indels can be either constant or gamma distributed</dt>
<dd><ul class="first last simple">
<li>REPEAT_CONFIG[&#8216;castor_parameter&#8217;][&#8216;rate_distribution&#8217;] == &#8216;constant&#8217;: no gamma distribution is used for the proPIP algorithm</li>
<li>REPEAT_CONFIG[&#8216;castor_parameter&#8217;][&#8216;rate_distribution&#8217;] == &#8216;gamma&#8217;: gamma distribution (n=6, alpha=0.5)</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>my_msa</strong> (<em>list of strings</em>) &#8211; List of sequences (str)</li>
<li><strong>realignment</strong> (<em>str</em>) &#8211; Either &#8220;mafft&#8221; or &#8220;proPIP&#8221;</li>
<li><strong>sequence_type</strong> (<em>str</em>) &#8211; Either &#8220;AA&#8221; or &#8220;DNA&#8221;</li>
<li><strong>user_path</strong> (<em>str</em>) &#8211; copy alignment files to user defined path</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">my_msa realigned (list of strings)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>decide what happens if branch length of tree is getting zero</li>
</ul>
</div>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_align.remove_char">
<code class="descclassname">tral.repeat.repeat_align.</code><code class="descname">remove_char</code><span class="sig-paren">(</span><em>str</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_align.html#remove_char"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_align.remove_char" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to remove a character in a sequence</p>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_align.remove_gaps">
<code class="descclassname">tral.repeat.repeat_align.</code><code class="descname">remove_gaps</code><span class="sig-paren">(</span><em>msa</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_align.html#remove_gaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_align.remove_gaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove columns in a MSA which contain only gaps.
Do not use MSA longer than 3000 characters.</p>
<p>Returns the MSA as a list without only-gap-containing columns.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>msa</strong> (<em>list of strings</em>) &#8211; List of sequences (str)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">msa (list of strings) with removed colums in case they only contain gaps</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-tral.repeat.repeat_exon">
<span id="repeat-exon"></span><h2>repeat_exon<a class="headerlink" href="#module-tral.repeat.repeat_exon" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="tral.repeat.repeat_exon.get_exon_measures">
<code class="descclassname">tral.repeat.repeat_exon.</code><code class="descname">get_exon_measures</code><span class="sig-paren">(</span><em>my_TR</em>, <em>exon_structure</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_exon.html#get_exon_measures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_exon.get_exon_measures" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate diverse exon measures</p>
<p>Exon structure parameters:
# exon_structure = [{&#8216;Exon Chr End (bp)&#8217;: &#8216;43478424&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43477252&#8217;, &#8216;CDS End&#8217;: &#8216;272&#8217;, &#8216;CDS Start&#8217;: &#8216;1&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43476658&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43476498&#8217;, &#8216;CDS End&#8217;: &#8216;433&#8217;, &#8216;CDS Start&#8217;: &#8216;273&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43476158&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43476036&#8217;, &#8216;CDS End&#8217;: &#8216;556&#8217;, &#8216;CDS Start&#8217;: &#8216;434&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43475664&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43475564&#8217;, &#8216;CDS End&#8217;: &#8216;657&#8217;, &#8216;CDS Start&#8217;: &#8216;557&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43475416&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43475194&#8217;, &#8216;CDS End&#8217;: &#8216;880&#8217;, &#8216;CDS Start&#8217;: &#8216;658&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43475046&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43474707&#8217;, &#8216;CDS End&#8217;: &#8216;951&#8217;, &#8216;CDS Start&#8217;: &#8216;881&#8217;}]</p>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_exon.get_exon_structure">
<code class="descclassname">tral.repeat.repeat_exon.</code><code class="descname">get_exon_structure</code><span class="sig-paren">(</span><em>my_TR</em>, <em>exon_structure</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_exon.html#get_exon_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_exon.get_exon_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Exon structure parameters:
# exon_structure = [{&#8216;Exon Chr End (bp)&#8217;: &#8216;43478424&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43477252&#8217;, &#8216;CDS End&#8217;: &#8216;272&#8217;, &#8216;CDS Start&#8217;: &#8216;1&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43476658&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43476498&#8217;, &#8216;CDS End&#8217;: &#8216;433&#8217;, &#8216;CDS Start&#8217;: &#8216;273&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43476158&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43476036&#8217;, &#8216;CDS End&#8217;: &#8216;556&#8217;, &#8216;CDS Start&#8217;: &#8216;434&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43475664&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43475564&#8217;, &#8216;CDS End&#8217;: &#8216;657&#8217;, &#8216;CDS Start&#8217;: &#8216;557&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43475416&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43475194&#8217;, &#8216;CDS End&#8217;: &#8216;880&#8217;, &#8216;CDS Start&#8217;: &#8216;658&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43475046&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43474707&#8217;, &#8216;CDS End&#8217;: &#8216;951&#8217;, &#8216;CDS Start&#8217;: &#8216;881&#8217;}]</p>
</dd></dl>

<dl class="data">
<dt id="tral.repeat.repeat_exon.logger">
<code class="descclassname">tral.repeat.repeat_exon.</code><code class="descname">logger</code><em class="property"> = &lt;logging.Logger object&gt;</em><a class="headerlink" href="#tral.repeat.repeat_exon.logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Functions to check whether the exon structure and the repeat unit structure are correlated.</p>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_exon.print_exon_structure">
<code class="descclassname">tral.repeat.repeat_exon.</code><code class="descname">print_exon_structure</code><span class="sig-paren">(</span><em>my_TR</em>, <em>exon_structure</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_exon.html#print_exon_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_exon.print_exon_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Exon structure parameters:
# exon_structure = [{&#8216;Exon Chr End (bp)&#8217;: &#8216;43478424&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43477252&#8217;, &#8216;CDS End&#8217;: &#8216;272&#8217;, &#8216;CDS Start&#8217;: &#8216;1&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43476658&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43476498&#8217;, &#8216;CDS End&#8217;: &#8216;433&#8217;, &#8216;CDS Start&#8217;: &#8216;273&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43476158&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43476036&#8217;, &#8216;CDS End&#8217;: &#8216;556&#8217;, &#8216;CDS Start&#8217;: &#8216;434&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43475664&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43475564&#8217;, &#8216;CDS End&#8217;: &#8216;657&#8217;, &#8216;CDS Start&#8217;: &#8216;557&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43475416&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43475194&#8217;, &#8216;CDS End&#8217;: &#8216;880&#8217;, &#8216;CDS Start&#8217;: &#8216;658&#8217;}, {&#8216;Exon Chr End (bp)&#8217;: &#8216;43475046&#8217;, &#8216;Exon Chr Start (bp)&#8217;: &#8216;43474707&#8217;, &#8216;CDS End&#8217;: &#8216;951&#8217;, &#8216;CDS Start&#8217;: &#8216;881&#8217;}]</p>
</dd></dl>

</div>
<div class="section" id="module-tral.repeat.repeat_io">
<span id="repeat-io"></span><h2>repeat_io<a class="headerlink" href="#module-tral.repeat.repeat_io" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">synopsis:</th><td class="field-body">Input/output for tandem repeats.</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="tral.repeat.repeat_io.evolved_tandem_repeats">
<code class="descclassname">tral.repeat.repeat_io.</code><code class="descname">evolved_tandem_repeats</code><span class="sig-paren">(</span><em>l</em>, <em>n</em>, <em>n_samples</em>, <em>sequence_type</em>, <em>job_id='job_id'</em>, <em>mutation_rate=50</em>, <em>tree='star'</em>, <em>indel_rate_per_site=False</em>, <em>return_type='repeat'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_io.html#evolved_tandem_repeats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_io.evolved_tandem_repeats" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate evolved sequences with ALF.</p>
<p>Simulate evolved sequences with ALF:
Dalquen, D. A., Anisimova, M., Gonnet, G. H. &amp; Dessimoz, C.
ALF&#8211;a simulation framework for genome evolution. Molecular Biology and Evolution 29,
1115–1123 (2012).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>l</strong> (<em>int</em>) &#8211; The length of the repeat unit</li>
<li><strong>n</strong> (<em>int</em>) &#8211; The number of repeat units in the tandem repeat</li>
<li><strong>n_samples</strong> (<em>int</em>) &#8211; The number of samples</li>
<li><strong>sequence_type</strong> (<em>str</em>) &#8211; Either &#8220;AA&#8221; or &#8220;DNA&#8221;</li>
<li><strong>job_id</strong> (<em>str</em>) &#8211; A tag for files produces with ALF, and result files.</li>
<li><strong>mutation_rate</strong> (<em>float</em>) &#8211; The mutation rate.</li>
<li><strong>tree</strong> (<em>str</em>) &#8211; The type of tree, e.g. &#8220;star&#8221; or &#8220;birthdeath&#8221;</li>
<li><strong>indel_rate_per_site</strong> (<em>int or False</em>) &#8211; The indel rate per site.</li>
<li><strong>return_type</strong> (<em>str</em>) &#8211; Either &#8220;repeat&#8221; or &#8220;list&#8221;</li>
<li><strong>sequence_length</strong> (<em>int</em>) &#8211; The total length of the simulated sequence</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Return type depends on <code class="docutils literal"><span class="pre">return_type</span></code>: <code class="docutils literal"><span class="pre">Repeat</span></code> or <code class="docutils literal"><span class="pre">Bio.Seq.Seq</span></code> instance.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_io.random_sequence">
<code class="descclassname">tral.repeat.repeat_io.</code><code class="descname">random_sequence</code><span class="sig-paren">(</span><em>n_samples</em>, <em>sequence_type='AA'</em>, <em>return_type='repeat'</em>, <em>equilibrium_frequencies='human'</em>, <em>l=0</em>, <em>n=0</em>, <em>sequence_length=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_io.html#random_sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_io.random_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate random sequence locally.</p>
<p>Simulate random sequence locally.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_samples</strong> (<em>int</em>) &#8211; The number of samples</li>
<li><strong>sequence_type</strong> (<em>str</em>) &#8211; Either &#8220;AA&#8221; or &#8220;DNA&#8221;</li>
<li><strong>return_type</strong> (<em>str</em>) &#8211; Either &#8220;repeat&#8221; or &#8220;list&#8221;</li>
<li><strong>equilibrium_frequencies</strong> (<em>str</em>) &#8211; Only &#8220;human&#8221; option available at current</li>
<li><strong>l</strong> (<em>int</em>) &#8211; The length of the repeat unit</li>
<li><strong>n</strong> (<em>int</em>) &#8211; The number of repeat units in the tandem repeat</li>
<li><strong>sequence_length</strong> (<em>int</em>) &#8211; The total length of the simulated sequence</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Return type depends on <code class="docutils literal"><span class="pre">return_type</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_io.read_fasta">
<code class="descclassname">tral.repeat.repeat_io.</code><code class="descname">read_fasta</code><span class="sig-paren">(</span><em>seq_filename</em>, <em>sequence_type='AA'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_io.html#read_fasta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_io.read_fasta" title="Permalink to this definition">¶</a></dt>
<dd><p>Read repeat from file in fasta format.</p>
<p>Read repeat from file in fasta format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>seq_filename</strong> (<em>str</em>) &#8211; Path to the repeats containing fasta file</li>
<li><strong>sequence_type</strong> (<em>str</em>) &#8211; Either &#8220;AA&#8221; or &#8220;DNA&#8221;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A list of Repeat instances.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(list of Repeat)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_io.save_repeat_fasta">
<code class="descclassname">tral.repeat.repeat_io.</code><code class="descname">save_repeat_fasta</code><span class="sig-paren">(</span><em>tandem_repeats</em>, <em>file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_io.html#save_repeat_fasta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_io.save_repeat_fasta" title="Permalink to this definition">¶</a></dt>
<dd><p>save multiple &lt;tandem_repeats&gt; in Fasta format in specified &lt;file&gt;</p>
<p>At current, only one TR per sequence can be defined, as the identifiers
in the dict &lt;tandem_repeats&gt; must be unique.</p>
<dl class="docutils">
<dt>Parameters: Dict of tandem repeats and identifiers.</dt>
<dd><p class="first">e.g. {&#8216;ENSP00012&#8217;: msa1, &#8216;ENSP00013&#8217;: msa2}</p>
<p class="last">&gt;ID
GHKI
GHKI
GH&#8211;</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_io.save_repeat_stockholm">
<code class="descclassname">tral.repeat.repeat_io.</code><code class="descname">save_repeat_stockholm</code><span class="sig-paren">(</span><em>tandem_repeat</em>, <em>file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_io.html#save_repeat_stockholm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_io.save_repeat_stockholm" title="Permalink to this definition">¶</a></dt>
<dd><p>save &lt;tandem_repeat&gt; in STOCKHOLM format in specified &lt;file&gt;</p>
<dl class="docutils">
<dt>Parameters: Tandem repeat MSA.</dt>
<dd><p class="first">e.g. [&#8220;ACDEF-&#8221;, &#8220;ACCDEF&#8221;]</p>
<p>More information in
<a class="reference external" href="ftp://selab.janelia.org/pub/software/hmmer3/3.0/Userguide.pdf">ftp://selab.janelia.org/pub/software/hmmer3/3.0/Userguide.pdf</a>
STOCKHOLM Format Example:</p>
<p># STOCKHOLM 1.0
seq1 ACDEF...GHIKL
seq2 ACDEF...GHIKL
seq3 ...EFMNRGHIKL</p>
<p class="last">seq1 MNPQTVWY
seq2 MNPQTVWY
seq3 MNPQT...
//</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_io.save_repeat_treks">
<code class="descclassname">tral.repeat.repeat_io.</code><code class="descname">save_repeat_treks</code><span class="sig-paren">(</span><em>tandem_repeats</em>, <em>file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_io.html#save_repeat_treks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_io.save_repeat_treks" title="Permalink to this definition">¶</a></dt>
<dd><p>Save multiple <cite>tandem_repeats</cite> in T-REKS format in specified <cite>file</cite></p>
<p>At current, only one TR per sequence can be defined, as the identifiers
in the dict &lt;tandem_repeats&gt; must be unique.</p>
<dl class="docutils">
<dt>Parameters: Dict of tandem repeats and identifiers.</dt>
<dd><p class="first">e.g. {&#8216;ENSP00012&#8217;: [msa1, begin1], &#8216;ENSP00013&#8217;: [msa2, begin2]}</p>
<p>T-REKS format example:</p>
<p>&gt;a
Length: 3 residues - nb: 3  from  1 to 10 - Psim:0.8076923076923077 region Length:42
GHKI
GHKI
GH&#8211;
<strong>******************</strong></p>
<p>Length: 3 residues - nb: 2  from  21 to 27 - Psim:0.7857142857142857 region Length:22
GHKI
GH&#8211;
<strong>******************</strong></p>
<p class="last">&gt;b
Length: 3 residues - nb: 3  from  1 to 10 - Psim:0.8095238095238095 region Length:20
UIR
UIR
UIR</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-tral.repeat.repeat_pvalue">
<span id="repeat-pvalue"></span><h2>repeat_pvalue<a class="headerlink" href="#module-tral.repeat.repeat_pvalue" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">synopsis:</th><td class="field-body">The repeat pvalue module.</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="tral.repeat.repeat_pvalue.calc_pvalues">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">calc_pvalues</code><span class="sig-paren">(</span><em>repeats, result_file_path, file_name, scoretypes=['phylo', 'phylo_gap'], gappy_data=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#calc_pvalues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.calc_pvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and save a null distribution for <code class="docutils literal"><span class="pre">repeats</span></code> scores for p-Value calculation.</p>
<p>You can use a different null distribution for each column of different length for both
the parsimony and the pSim score. Therefore, calculate the structure of the TR before
you calculate the null distribution of tandem repeat scores of tandem repeats with
the same gap distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>repeats</strong> (<em>list of Repeat</em>) &#8211; A list of <code class="docutils literal"><span class="pre">Repeat</span></code> instances.</li>
<li><strong>result_file_path</strong> (<em>str</em>) &#8211; Path to result folder.</li>
<li><strong>file_name</strong> (<em>str</em>) &#8211; Name of result file.</li>
<li><strong>scoretypes</strong> (<em>list of str</em>) &#8211; List of scores. E.g. [&#8216;phylo&#8217;,&#8217;phylo_gap&#8217;].</li>
<li><strong>gappy_data</strong> (<em>bool</em>) &#8211; True if any of <code class="docutils literal"><span class="pre">repeats</span></code> contain gaps, else False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_pvalue.calculate_repeat_structure">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">calculate_repeat_structure</code><span class="sig-paren">(</span><em>tandemrepeat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#calculate_repeat_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.calculate_repeat_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the number of columns with a certain number of gaps for each column in
a <code class="docutils literal"><span class="pre">Repeat</span></code> instance.</p>
<p>You can use a different null distribution for each column of different length for both
the parsimony and the pSim score. Therefore, calculate the structure of the TR before
you calculate the null distribution of tandem repeat scores of tandem repeats with
the same gap distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<em>int</em>) &#8211; The number of repeat units.</li>
<li><strong>score</strong> &#8211; The heuristic model used. E.g. &#8220;psim&#8221;.</li>
<li><strong>sequence_type</strong> (<em>str</em>) &#8211; The type of the sequence: either &#8220;AA&#8221; or &#8220;DNA&#8221;.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">l_repeat_structure (list)
n_repeat_structure (int)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-5">
<p class="first admonition-title">Todo</p>
<p class="last">Include exact definition of returned values.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_pvalue.column_pdf">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">column_pdf</code><span class="sig-paren">(</span><em>n</em>, <em>score_type='psim'</em>, <em>sequence_type='AA'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#column_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.column_pdf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Load and return the probability density function of the score on random</dt>
<dd><code class="docutils literal"><span class="pre">sequence_type</span></code> data of length <code class="docutils literal"><span class="pre">n</span></code>.</dd>
</dl>
<p>Load and return the probability density function of the score on random
<code class="docutils literal"><span class="pre">sequence_type</span></code> data of length <code class="docutils literal"><span class="pre">n</span></code>.
This method handels scores with distributions independent of <code class="docutils literal"><span class="pre">l</span></code>. This includes
all parsimony scores, and excludes model based scores.</p>
<p>The order of the values in the probability density function is WORST FIRST: The first
values describe the probability for &#8220;bad&#8221; scores, the last values the probabilities
for &#8220;top&#8221; scores.</p>
<p>Currently, for all models values are available until</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">n_max</span></code> = 150</li>
</ul>
</div></blockquote>
<p>For <code class="docutils literal"><span class="pre">n</span></code> &lt;=  <code class="docutils literal"><span class="pre">n_max</span></code> all values are available. If no distribution is available for
a given <code class="docutils literal"><span class="pre">n</span></code> the closest values for <code class="docutils literal"><span class="pre">n</span></code> is used.</p>
<p>For values of <code class="docutils literal"><span class="pre">n</span></code> above <code class="docutils literal"><span class="pre">n_max</span></code>, the <code class="docutils literal"><span class="pre">n_max</span></code> pdf is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<em>int</em>) &#8211; The number of repeat units.</li>
<li><strong>score_type</strong> &#8211; The heuristic model used. E.g. &#8220;psim&#8221;.</li>
<li><strong>sequence_type</strong> (<em>str</em>) &#8211; The type of the sequence: either &#8220;AA&#8221; or &#8220;DNA&#8221;.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A numpy list of length 10.000</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-6">
<p class="first admonition-title">Todo</p>
<p class="last">Check return type.</p>
</div>
<div class="admonition-todo admonition" id="index-7">
<p class="first admonition-title">Todo</p>
<p class="last">Check how this method concurs with the <code class="docutils literal"><span class="pre">empirical_list</span></code> method.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_pvalue.d_average_multinom">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">d_average_multinom</code><span class="sig-paren">(</span><em>l</em>, <em>n</em>, <em>sequence_type</em>, <em>score_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#d_average_multinom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.d_average_multinom" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for the analytic calculation of parsimony or pSim scores.</p>
<p>Called by <code class="docutils literal"><span class="pre">d_average_multiple_max_multinom</span></code> or <code class="docutils literal"><span class="pre">d_average_multiple_pars_multinom</span></code>.</p>
<p>Return the <code class="docutils literal"><span class="pre">l</span></code>-times self-convoluted pdf of the score on random sequence_type data
of length <code class="docutils literal"><span class="pre">n</span></code>. The order of the pdf is kept from <code class="docutils literal"><span class="pre">column_pdf()</span></code>.</p>
<p>For details see:</p>
<p>Schaper, E., Kajava, A., Hauser, A., &amp; Anisimova, M. Repeat or not repeat?
&#8211;Statistical validation of tandem repeat prediction in genomic sequences.
Nucleic Acids Research (2012).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>l</strong> (<em>int</em>) &#8211; The length of the repeat unit.</li>
<li><strong>n</strong> (<em>int</em>) &#8211; The number of repeat units.</li>
<li><strong>sequence_type</strong> (<em>str</em>) &#8211; The type of the sequence: either &#8220;AA&#8221; or &#8220;DNA&#8221;.</li>
<li><strong>score_type</strong> &#8211; The model of repeat evolution used. Either &#8216;psim&#8217; or &#8216;parsimony&#8217;.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(description missing)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">if precision higher than max(uint32) use uint64 instead.
CHECK: <a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.types.html">http://docs.scipy.org/doc/numpy/user/basics.types.html</a></p>
</div>
<div class="admonition-todo admonition" id="index-8">
<p class="first admonition-title">Todo</p>
<p class="last">Describe return value.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_pvalue.d_average_multiple_max_multinom">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">d_average_multiple_max_multinom</code><span class="sig-paren">(</span><em>tandemrepeat</em>, <em>precision=10000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#d_average_multiple_max_multinom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.d_average_multiple_max_multinom" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Calculate null distribution for e.g. the pSim score for repeats of type <code class="docutils literal"><span class="pre">tandemrepeat</span></code></dt>
<dd>as a probability density function.</dd>
</dl>
<p>Analytically calculate the p-Value distribution for the pSim score for repeats of
type <code class="docutils literal"><span class="pre">tandemrepeat</span></code>. The derivation is described in:</p>
<p>Schaper, E., Kajava, A., Hauser, A., &amp; Anisimova, M. Repeat or not repeat?
&#8211;Statistical validation of tandem repeat prediction in genomic sequences.
Nucleic Acids Research (2012).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tandemrepeat</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; A <code class="docutils literal"><span class="pre">Repeat</span></code> instance.</li>
<li><strong>precision</strong> (<em>float</em>) &#8211; The precision of the returned probability density function in</li>
<li><strong>of the length of the resulting list.</strong> (<em>terms</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>p</strong> &#8211;
cumulated probabilities from 0 to 1.
unnamed (list of float): scores corresponding to the probabilities in <code class="docutils literal"><span class="pre">p</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of float</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">if precision higher than max(uint32) use uint64 instead.
CHECK: <a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.types.html">http://docs.scipy.org/doc/numpy/user/basics.types.html</a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_pvalue.d_average_multiple_pars_multinom">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">d_average_multiple_pars_multinom</code><span class="sig-paren">(</span><em>tandemrepeat</em>, <em>precision=10000.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#d_average_multiple_pars_multinom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.d_average_multiple_pars_multinom" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Calculate null distribution for the parsimony score for repeats of type <code class="docutils literal"><span class="pre">tandemrepeat</span></code></dt>
<dd>as a probability density function.</dd>
</dl>
<p>Analytically calculate the p-Value distribution for the parsimony score for repeats of
type <code class="docutils literal"><span class="pre">tandemrepeat</span></code>. The derivation is described in:</p>
<p>Schaper, E., Kajava, A., Hauser, A., &amp; Anisimova, M. Repeat or not repeat?
&#8211;Statistical validation of tandem repeat prediction in genomic sequences.
Nucleic Acids Research (2012).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tandemrepeat</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; A <code class="docutils literal"><span class="pre">Repeat</span></code> instance.</li>
<li><strong>precision</strong> (<em>float</em>) &#8211; The precision of the returned probability density function in</li>
<li><strong>of the length of the resulting list.</strong> (<em>terms</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>p</strong> &#8211;
cumulated probabilities from 0 to 1.
unnamed (list of float): scores corresponding to the probabilities in <code class="docutils literal"><span class="pre">p</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of float</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">if precision higher than max(uint32) use uint64 instead.
CHECK: <a class="reference external" href="http://docs.scipy.org/doc/numpy/user/basics.types.html">http://docs.scipy.org/doc/numpy/user/basics.types.html</a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_pvalue.empirical_list">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">empirical_list</code><span class="sig-paren">(</span><em>l</em>, <em>n</em>, <em>sequence_type='AA'</em>, <em>score_type='phylo'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#empirical_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.empirical_list" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Load and return a numpy list with 10,000 empirical values of the user defined</dt>
<dd>distribution from an external file.</dd>
</dl>
<p>If no distribution is available for a given <code class="docutils literal"><span class="pre">l</span></code> and <code class="docutils literal"><span class="pre">n</span></code>, the closest values for
<code class="docutils literal"><span class="pre">l</span></code> and <code class="docutils literal"><span class="pre">n</span></code> are chosen instead.</p>
<p>For the standard model score &#8220;phylo&#8221;, currently values are available until</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">l_max</span></code> = 99</li>
<li><code class="docutils literal"><span class="pre">n_max</span></code> = 49</li>
<li><code class="docutils literal"><span class="pre">total_repeat_length_max</span></code> = 1000</li>
</ul>
</div></blockquote>
<p>For <code class="docutils literal"><span class="pre">l</span></code> &lt;=  <code class="docutils literal"><span class="pre">l_max</span></code> and <code class="docutils literal"><span class="pre">n</span></code> &lt;=  <code class="docutils literal"><span class="pre">n_max</span></code> and <code class="docutils literal"><span class="pre">n*l</span></code> &lt;=  <code class="docutils literal"><span class="pre">total_repeat_length_max</span></code>
all values are available.</p>
<p>For other values, we use the closest distribution, assuming that values change little
(heuristic assumption!).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>l</strong> (<em>int</em>) &#8211; The length of the repeat unit.</li>
<li><strong>n</strong> (<em>int</em>) &#8211; The number of repeat units.</li>
<li><strong>sequence_type</strong> (<em>str</em>) &#8211; The type of the sequence: either &#8220;AA&#8221; or &#8220;DNA&#8221;.</li>
<li><strong>score_type</strong> &#8211; The model of repeat evolution used. E.g. &#8220;phylo&#8221;.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A numpy list of length 10.000</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-9">
<p class="first admonition-title">Todo</p>
<p class="last">Define &#8220;phylo&#8221; model.</p>
</div>
<div class="admonition-todo admonition" id="index-10">
<p class="first admonition-title">Todo</p>
<p class="last">Perhaps add distributions beyond l_max, n_max.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_pvalue.gap_penalty">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">gap_penalty</code><span class="sig-paren">(</span><em>tandemrepeat</em>, <em>mu</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#gap_penalty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.gap_penalty" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the gap penalty for a <code class="docutils literal"><span class="pre">Repeat</span></code> given mutation rate <code class="docutils literal"><span class="pre">mu</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tandemrepeat</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; A <code class="docutils literal"><span class="pre">Repeat</span></code> instance.</li>
<li><strong>mu</strong> (<em>float</em>) &#8211; The mutation rate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Gap penalty (float)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-11">
<p class="first admonition-title">Todo</p>
<p class="last">Define <code class="docutils literal"><span class="pre">mu</span></code> more precisely.</p>
</div>
<div class="admonition-todo admonition" id="index-12">
<p class="first admonition-title">Todo</p>
<p class="last">Is this function called from anywhere? In case, consider refactoring.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_pvalue.pvalue_from_empirical_list">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">pvalue_from_empirical_list</code><span class="sig-paren">(</span><em>tandemrepeat</em>, <em>score_type='phylo'</em>, <em>score_value=None</em>, <em>empirical=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#pvalue_from_empirical_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.pvalue_from_empirical_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the p-Value of a score_type for the given <cite>tandemrepeat</cite>.</p>
<p>The p-Value is the number of scores for comparable tandem repeats, i.e. of
same repeat unit length and repeat unit copy number that are as good or
better.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tandemrepeat</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; An instance of the Repeat class.</li>
<li><strong>score_type</strong> &#8211; The model of repeat evolution used. E.g. &#8220;phylo&#8221;.</li>
<li><strong>score_value</strong> (<em>float</em>) &#8211; The value of the score of the Repeat instance.</li>
<li><strong>empirical</strong> &#8211; The null distribution of the score for repeats of the same
type.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A float.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="repeat_list.html#tral.repeat_list.repeat_list.pvalue" title="tral.repeat_list.repeat_list.pvalue">pvalue</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_pvalue.pvalue_pars">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">pvalue_pars</code><span class="sig-paren">(</span><em>tandemrepeat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#pvalue_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.pvalue_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the p-Value of the parsimony score for a Repeat.</p>
<p>Retrieve the probability density function for repeats of the same type as
<code class="docutils literal"><span class="pre">tandemrepeat</span></code>. Then, calculate the p-Value given this probability
density function, and the parsimony score of <code class="docutils literal"><span class="pre">tandemrepeat</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tandemrepeat</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; A <code class="docutils literal"><span class="pre">Repeat</span></code> instance.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">p-Value (float)</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-13">
<p class="first admonition-title">Todo</p>
<p class="last">Check the method&#8217;s behaviour if <code class="docutils literal"><span class="pre">tandemrepeat</span></code> s parsimony
score has not been calculated before.</p>
</div>
<div class="admonition-todo admonition" id="index-14">
<p class="first admonition-title">Todo</p>
<p class="last">Check exception: if pdf == False: return 1.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_pvalue.pvalue_psim">
<code class="descclassname">tral.repeat.repeat_pvalue.</code><code class="descname">pvalue_psim</code><span class="sig-paren">(</span><em>tandemrepeat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_pvalue.html#pvalue_psim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_pvalue.pvalue_psim" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the p-Value of the pSim score for a Repeat.</p>
<p>Retrieve the probability density function for repeats of the same type as <code class="docutils literal"><span class="pre">tandemrepeat</span></code>.
Then, calculate the p-Value given this probability density function, and the
pSim score of <code class="docutils literal"><span class="pre">tandemrepeat</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tandemrepeat</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; A <code class="docutils literal"><span class="pre">Repeat</span></code> instance.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">p-Value (float)</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-15">
<p class="first admonition-title">Todo</p>
<p class="last">Check the method&#8217;s behaviour if <code class="docutils literal"><span class="pre">tandemrepeat</span></code> s parsimony score has not been
calculated before.</p>
</div>
<div class="admonition-todo admonition" id="index-16">
<p class="first admonition-title">Todo</p>
<p class="last">Check exception: if pdf == False: return 1.</p>
</div>
<div class="admonition-todo admonition" id="index-17">
<p class="first admonition-title">Todo</p>
<p class="last">Describe <code class="docutils literal"><span class="pre">precision</span></code>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-tral.repeat.repeat_score">
<span id="repeat-score"></span><h2>repeat_score<a class="headerlink" href="#module-tral.repeat.repeat_score" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">synopsis:</th><td class="field-body">The repeat score module.</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="tral.repeat.repeat_score.K80">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">K80</code><span class="sig-paren">(</span><em>kappa=2.59</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#K80"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.K80" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.LG">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">LG</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#LG"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.LG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.TN93">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">TN93</code><span class="sig-paren">(</span><em>alpha_1=0.3</em>, <em>alpha_2=0.4</em>, <em>beta=0.7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#TN93"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.TN93" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.calculate_pdf_scores">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">calculate_pdf_scores</code><span class="sig-paren">(</span><em>repeats, result_file_path, file_name, scoreslist=['phylo_gap01']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#calculate_pdf_scores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.calculate_pdf_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>CALCULATE THE PROBABILITY DISTRIBUTION OF SCORES</p>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.entropy">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">entropy</code><span class="sig-paren">(</span><em>column</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the entropy of a list.</p>
<p>Calculate the entropy of list. Assume that the frequency of elements in
the list reflects a probability density estimator.</p>
<p>For an exact description see:</p>
<p>Schaper, E., Kajava, A., Hauser, A., &amp; Anisimova, M. Repeat or not repeat?
&#8211;Statistical validation of tandem repeat prediction in genomic sequences.
Nucleic Acids Research (2012).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>column</strong> (<em>list of str</em>) &#8211; List of elements that can be ordered in a set, e.g.
str or int.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The entropy of <code class="docutils literal"><span class="pre">column</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.load_equilibrium_freq">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">load_equilibrium_freq</code><span class="sig-paren">(</span><em>file_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#load_equilibrium_freq"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.load_equilibrium_freq" title="Permalink to this definition">¶</a></dt>
<dd><p>Load equilibrium frequencies from a substitution matrix file.</p>
<p>Load equilibrium frequencies from a substitution matrix file. Note that
with minor changes, the whole amino acid substitution matrix could be
returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file_name</strong> (<em>str</em>) &#8211; Path to substitution matrix file, E.g. LG.dat.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Dictionary of one letter amino acid codes and
float value</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(Dict of str, float)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.loglikelihood_gaps_starphylogeny_zipfian">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">loglikelihood_gaps_starphylogeny_zipfian</code><span class="sig-paren">(</span><em>t</em>, <em>tandem_repeat</em>, <em>indel_rate_per_site=0.01</em>, <em>gaps='row_wise'</em>, <em>indel_zipf=1.821</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#loglikelihood_gaps_starphylogeny_zipfian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.loglikelihood_gaps_starphylogeny_zipfian" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Calculate the log-likelihood of the gap structure in a</dt>
<dd><code class="docutils literal"><span class="pre">tandem</span> <span class="pre">repeat</span></code> assuming a star tree.</dd>
</dl>
<p>Calculate the log-likelihood of the gap structure in a <code class="docutils literal"><span class="pre">tandem</span> <span class="pre">repeat</span></code>
assuming a star tree (i.e. repeat unit correlations are not modeled). The
gap length model is a zipfian distribution with parameter <code class="docutils literal"><span class="pre">indel_zipf</span></code>.
The gap generation model is a simple poisson model with rate parameter
<code class="docutils literal"><span class="pre">indel_rate_per_site</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>float</em>) &#8211; The divergence of the <code class="docutils literal"><span class="pre">tandem_repeat</span></code> units.</li>
<li><strong>tandem_repeat</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; An instance of the <code class="docutils literal"><span class="pre">Repeat</span></code> class.</li>
<li><strong>indel_rate_per_site</strong> (<em>float</em>) &#8211; The mutation rate of insertions and
deletions, as opposed to <code class="docutils literal"><span class="pre">t</span></code>.</li>
<li><strong>gaps</strong> (<em>str</em>) &#8211; The mode of gap counting. Options are &#8220;row_wise&#8221;,</li>
<li><strong>&quot;ignore_trailing_gaps&quot; and</strong> (<em>&quot;ignore_coherent_deletions&quot;,</em>) &#8211; </li>
<li><strong>&quot;ignore_trailing_gaps_and_coherent_deletions&quot;.</strong> &#8211; </li>
<li><strong>indel_zipf</strong> (<em>float</em>) &#8211; The parameter of the Zipfian distribution.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The loglikelihood value for the gap structure of the tandem
repeat.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-18">
<p class="first admonition-title">Todo</p>
<p class="last">USE LOG EARLIER, NOT JUST IN RETURN STATEMENT</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.loglikelihood_substitution">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">loglikelihood_substitution</code><span class="sig-paren">(</span><em>t</em>, <em>Q</em>, <em>eq_freq</em>, <em>alphabet</em>, <em>tandem_repeat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#loglikelihood_substitution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.loglikelihood_substitution" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Calculate the likelihood of a repeat assuming a star tree and a</dt>
<dd>sequence model defined by <code class="docutils literal"><span class="pre">Q</span></code>, <code class="docutils literal"><span class="pre">t</span></code>, <code class="docutils literal"><span class="pre">eq_freq</span></code> and <code class="docutils literal"><span class="pre">alphabet</span></code>.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>float</em>) &#8211; The divergence of the <code class="docutils literal"><span class="pre">tandem_repeat</span></code> units.</li>
<li><strong>Q</strong> (<em>dict ?</em>) &#8211; A substitution matrix.</li>
<li><strong>eq_freq</strong> (<em>dict ?</em>) &#8211; Equilibrium frequencies of all chars.</li>
<li><strong>alphabet</strong> (<em>dict of str,?</em>) &#8211; An alphabet from a substitution matrix.</li>
<li><strong>tandem_repeat</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; An instance of the <code class="docutils literal"><span class="pre">Repeat</span></code> class.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The loglikelihood value for the tandem repeat.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.mean_similarity">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">mean_similarity</code><span class="sig-paren">(</span><em>repeat</em>, <em>measure_of_similarity</em>, <em>ignore_gaps=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#mean_similarity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.mean_similarity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Calculate the mean similarity of all columns in the multiple sequence</dt>
<dd>alignment in <code class="docutils literal"><span class="pre">repeat</span></code> according to a <code class="docutils literal"><span class="pre">measure_of_similarity</span></code>.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>repeat</strong> (<a class="reference internal" href="#tral.repeat.repeat.Repeat" title="tral.repeat.repeat.Repeat"><em>Repeat</em></a>) &#8211; An instance of the Repeat class.</li>
<li><strong>measure_of_similarity</strong> (<em>str</em>) &#8211; Either &#8220;entropy&#8221;, &#8220;parsimony&#8221;, or &#8220;pSim&#8221;.</li>
<li><strong>ignore_gaps</strong> (<em>boolean</em>) &#8211; Are gaps, &#8220;-&#8221; treated as chars (False) or ignored
(True).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A similarity measure for the repeat units in <code class="docutils literal"><span class="pre">repeat</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.optimisation">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">optimisation</code><span class="sig-paren">(</span><em>function</em>, <em>args</em>, <em>start_min=0.5</em>, <em>start_max=1.5</em>, <em>n_iteration=14</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#optimisation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.optimisation" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary one-dimensional optimisation of <code class="docutils literal"><span class="pre">function</span></code>.</p>
<p>Perform a binary one dimensional optimisation of parameter <code class="docutils literal"><span class="pre">t</span></code> on
<code class="docutils literal"><span class="pre">function</span></code> with the additional list of arguments/parameters <code class="docutils literal"><span class="pre">args</span></code>.
Start on a given range of start, and iterate <code class="docutils literal"><span class="pre">n_iteration</span></code> times. Return
the maximum of the function, together with the maximum parameter <code class="docutils literal"><span class="pre">t</span></code> as a
tuple.</p>
<p>In addition to <code class="docutils literal"><span class="pre">start_min</span></code> and <code class="docutils literal"><span class="pre">start_max</span></code>, additional hard boundaries
on the optimisation parameter <code class="docutils literal"><span class="pre">t</span></code> are hard-coded: t E [0.0000000001, 100]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function</strong> (<em>method</em>) &#8211; Method with input (float, <code class="docutils literal"><span class="pre">args</span></code>) and output float.</li>
<li><strong>args</strong> (<em>list of items</em>) &#8211; List of arguments for <code class="docutils literal"><span class="pre">function</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Kwargs:</dt>
<dd>start_min (float): Minimum value of function parameter <code class="docutils literal"><span class="pre">t</span></code>.
start_max (float): Maximum value of function parameter <code class="docutils literal"><span class="pre">t</span></code>.
n_iteration (int): Number of iterations until optimisation results are returned.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">float,
Corresponding function parameter: float)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">tuple (Maximum of function<span class="target" id="index-19"></span><div class="admonition-todo admonition">
<p class="first admonition-title">Todo</p>
<p class="last">Check why <code class="docutils literal"><span class="pre">region_bounded</span></code> is hardcoded at current.</p>
</div>
<span class="target" id="index-20"></span><div class="admonition-todo admonition">
<p class="first admonition-title">Todo</p>
<p class="last">Check why <code class="docutils literal"><span class="pre">stepsize</span></code> is hardcoded at current.</p>
</div>
<span class="target" id="index-21"></span><div class="admonition-todo admonition">
<p class="first admonition-title">Todo</p>
<p class="last">Generalise hard-coded optimisation parameter boundaries.</p>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.pSim">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">pSim</code><span class="sig-paren">(</span><em>column</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#pSim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.pSim" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the pSim score of a list.</p>
<p>Calculate the pSim score on <code class="docutils literal"><span class="pre">column</span></code>:  Count the frequency of the most
frequent element in a <code class="docutils literal"><span class="pre">column</span></code> of a multiple sequence alignment.</p>
<p>For an exact description see:</p>
<p>Schaper, E., Kajava, A., Hauser, A., &amp; Anisimova, M. Repeat or not repeat?
&#8211;Statistical validation of tandem repeat prediction in genomic sequences.
Nucleic Acids Research (2012).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>column</strong> (<em>list of str</em>) &#8211; A list of elements.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The pSim score of <code class="docutils literal"><span class="pre">column</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="tral.repeat.repeat_score.parsimony">
<code class="descclassname">tral.repeat.repeat_score.</code><code class="descname">parsimony</code><span class="sig-paren">(</span><em>column</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tral/repeat/repeat_score.html#parsimony"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tral.repeat.repeat_score.parsimony" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the parsimony score of a list.</p>
<p>Calculate the parsimony score on <code class="docutils literal"><span class="pre">column</span></code>:  Count the number of changes
in a <code class="docutils literal"><span class="pre">column</span></code> of a multiple sequence alignment and divide by the
maximally possible number of changes.</p>
<p>For an exact description see:</p>
<p>Schaper, E., Kajava, A., Hauser, A., &amp; Anisimova, M. Repeat or not repeat?
&#8211;Statistical validation of tandem repeat prediction in genomic sequences.
Nucleic Acids Research (2012).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>column</strong> (<em>list of str</em>) &#8211; A <code class="docutils literal"><span class="pre">list</span></code> of two or more elements that can be</li>
<li><strong>in a set, e.g. str or int</strong> (<em>ordered</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The parsimony score of <code class="docutils literal"><span class="pre">column</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-22">
<p class="first admonition-title">Todo</p>
<p class="last">At which step shall we assert that the length of <code class="docutils literal"><span class="pre">column</span></code> &gt; 1?</p>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>


  </body>
</html>